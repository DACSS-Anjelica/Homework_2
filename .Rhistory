styler:::style_selection()
styler:::style_selection()
styler:::style_selection()
styler:::style_selection()
styler:::style_selection()
styler:::style_selection()
styler:::style_selection()
styler:::style_selection()
styler:::style_selection()
styler:::style_selection()
styler:::style_selection()
librariesNeeded = c("igraph","ggplot2","ggraph")
librariesNeeded %in% rownames(installed.packages())
set.seed(123)
rm(list = ls())
##
fileLink = 'https://github.com/DACSS-Anjelica/Homework_2/raw/refs/heads/main/seattleTop.xlsx'
edges = rio::import(fileLink, which = 'edges')
adjacency = rio::import(fileLink, which = 'adjacency')
attributes = rio::import(fileLink,which ="attributes")
library(igraph) # package needed
EliteNe = graph_from_data_frame(edges, directed = F)
summary(EliteNet)
librariesNeeded = c("igraph","ggplot2","ggraph")
librariesNeeded %in% rownames(installed.packages())
set.seed(123)
rm(list = ls())
##
fileLink = 'https://github.com/DACSS-Anjelica/Homework_2/raw/refs/heads/main/seattleTop.xlsx'
edges = rio::import(fileLink, which = 'edges')
adjacency = rio::import(fileLink, which = 'adjacency')
attributes = rio::import(fileLink,which ="attributes")
library(igraph) # package needed
EliteNet = graph_from_data_frame(edges, directed = F)
summary(EliteNet)
# prepare matrix
row.names(adjacency) <- adjacency[, 1] # first column for index
adjacency <- adjacency[, -1] # deleting the first column
adjacencyMatrix <- as.matrix(adjacency)
# the making...
EliteNet <- graph_from_adjacency_matrix(adjacencyMatrix, mode = "undirected")
summary(EliteNet)
V(EliteNet)
E(EliteNet)
# edges
E(EliteNet)$weight=1
# EliteNet=set_edge_attr(EliteNet,"weight", value = 1)
#nodes
V(EliteNet)$male=attributes$male
V(EliteNet)$followers=attributes$followers
# EliteNet=set_vertex_attr(EliteNet, "followers", value=attributes$followers)
##
# E(EliteNet)$weight
# edge_attr_names(EliteNet)
# V(EliteNet)$followers
# vertex_attr_names(EliteNet)
summary(EliteNet)
library(ggraph)
base <- ggraph(graph = EliteNet)
base + geom_node_label(
aes(
label = name,
color = as.factor(male)
),
repel = TRUE, show.legend = F
) +
geom_edge_link(alpha = 0.1) +
scale_color_manual(values = c("red", "blue"))
is_connected(EliteNet)
graph.density(EliteNet)
diameter(EliteNet)
assortativity_degree(EliteNet,directed = F)
assortativity_nominal(EliteNet,as.factor(V(EliteNet)$male),directed = F)
assortativity(EliteNet,V(EliteNet)$followers,directed = T)
eigen <- eigen_centrality(EliteNet)$vector
close <- closeness(EliteNet, normalized = T)
betw <- betweenness(EliteNet, normalized = T)
DFCentrality <- as.data.frame(cbind(eigen, close, betw), stringsAsFactors = F)
names(DFCentrality) <- c("Eigenvector", "Closeness", "Betweenness")
DFCentrality$person <- row.names(DFCentrality)
row.names(DFCentrality) <- NULL
## see
head(DFCentrality)
library(ggplot2)
ggplot(DFCentrality, aes(x = Betweenness, y = Closeness)) +
theme_classic() +
geom_text(aes(label = person, size = Eigenvector), show.legend = T, alpha = 0.5)
HubNodes <- dplyr::top_n(DFCentrality, 2, Eigenvector)$person
HubNodes
NodeCount <- length(V(EliteNet))
V(EliteNet)$label <- ""
for (index in seq(1:NodeCount)) {
currentName <- V(EliteNet)$name[index]
if (currentName %in% HubNodes) {
V(EliteNet)$label[index] <- currentName
}
}
library(ggraph)
base <- ggraph(graph = EliteNet)
base + geom_node_label(aes(label = label),
repel = TRUE,
show.legend = F,
color = "red"
) +
geom_edge_link(alpha = 0.1)
RandomNet <- sample_gnp(length(V(EliteNet)), p = edge_density(EliteNet))
transitivity(EliteNet) / transitivity(RandomNet)
# Membership vector will be selected based
# on the highest modularity score
partition_girvanNewman_best <- cluster_edge_betweenness(EliteNet)
table(membership(partition_girvanNewman_best))
max(partition_girvanNewman_best$modularity)
partition_louvain_optimal <- cluster_louvain(EliteNet)
table(membership(partition_louvain_optimal))
max(partition_louvain_optimal$modularity)
V(EliteNet)$louvain <- as.factor(membership(partition_louvain_optimal))
V(EliteNet)$girvanNewman <- as.factor(membership(partition_girvanNewman_best))
base <- ggraph(graph = EliteNet, layout = "fr") + geom_edge_link(alpha = 0.2)
base + geom_node_point(aes(color = louvain), show.legend = T, size = 4)
V(EliteNet)$degree <- degree(EliteNet)
ggraph(EliteNet,
layout = "hive",
axis = louvain,
sort.by = degree
) +
geom_edge_hive(color = "grey80") +
geom_axis_hive(aes(colour = louvain),
label = F
) +
geom_node_point(aes(colour = louvain)) +
geom_node_text(aes(label = name),
repel = TRUE,
max.overlaps = 50, # avoid overlap
size = 2.5
) +
coord_fixed()
# you need numeric here:
V(EliteNet)$louvain <- as.numeric(V(EliteNet)$louvain)
V(EliteNet)$girvanNewman <- as.numeric(V(EliteNet)$girvanNewman)
# so this works
write_graph(EliteNet, "EliteNet_R.graphml", "graphml")
edge.density(EliteNet)
graph.density(EliteNet)
styler:::style_selection()
styler:::style_selection()
styler:::style_selection()
library(igraph)
library(ggraph)
set.seed(123)
actors <- read_graph("hollywood.graphml", format='graphml')
actors <- read_graph("hollywood.graphml", format='graphml')
summary(actors)
ggraph(graph = actors) +
geom_edge_link(
aes(label = weight), # Use weight for both label and width
alpha = 0.5,
label_size = 2.5,
angle_calc = 'along' # Optional: Draws the label along the edge line
) +
geom_node_text(
aes(label = name, color = as.factor(wonOscar)),
repel = TRUE
) +
scale_color_manual(values = c('red', 'blue')) +
theme_graph()
styler:::style_selection()
actors <- read_graph("https://raw.githubusercontent.com/DACSS-Anjelica/Homework_2/refs/heads/main/hollywood.graphml", format='graphml')
summary(actors)
styler:::style_selection()
V(actors)$eigen_centrality <- eigen_centrality(actors, weights = E(actors)$weight)$vector
styler:::style_selection()
# Eigenvector Centrality
w_strength <- E(actors)$weight
w_dist <- 1 / w_strength
eigen <- eigen_centrality(actors, weights = w_strength)$vector
close <- closeness(actors, weights = w_dist, normalized = TRUE)
betw  <- betweenness(actors, weights = w_dist, normalized = TRUE)
# Eigenvector Centrality
w_strength <- E(actors)$weight
w_dist <- 1 / w_strength
eigen <- eigen_centrality(actors, weights = w_strength)$vector
close <- closeness(actors, weights = w_dist, normalized = TRUE)
betw  <- betweenness(actors, weights = w_dist, normalized = TRUE)
DFCentrality <- data.frame(
Eigenvector = eigen,
Closeness = close,
Betweenness = betw,
person = V(actors)$name,
stringsAsFactors = FALSE
)
head(DFCentrality)
M <- DFCentrality[, c("Eigenvector", "Closeness", "Betweenness")]
cor_mat <- cor(M, use = "pairwise.complete.obs")
print(round(cor_mat, 3))
# Simple correlation heatmap (no extra packages needed)
cor_df <- as.data.frame(as.table(cor_mat))
names(cor_df) <- c("Measure1", "Measure2", "Correlation")
ggplot(cor_df, aes(Measure1, Measure2, fill = Correlation)) +
geom_tile() +
geom_text(aes(label = round(Correlation, 2)), size = 4) +
coord_equal() +
theme_minimal() +
labs(title = "Correlation of centrality measures")
# Optional scatterplot matrix style (basic)
pairs(M, main = "Centrality relationships (pairs plot)")
styler:::style_selection()
ggraph(graph = actors) +
geom_edge_link(aes(label = weight), alpha = 0.5, label_size = 2.5, angle_calc = "along") +
geom_node_text(aes(label = name, color = as.factor(wonOscar)), repel = TRUE) +
scale_color_manual(values = c("red", "blue")) +
theme_graph()
# Eigenvector Centrality
eigen <- eigen_centrality(actors)$vector
# Closeness
close <- closeness(actors, normalized = TRUE)
#Betweeness
betw  <- betweenness(actors, normalized = TRUE)
DFCentrality <- data.frame(
person = V(actors)$name,
Eigenvector = eigen,
Closeness = close,
Betweenness = betw,
stringsAsFactors = FALSE
)
# Eigenvector Centrality
eigen <- eigen_centrality(actors)$vector
# Closeness
close <- closeness(actors, normalized = TRUE)
#Betweeness
betw  <- betweenness(actors, normalized = TRUE)
DFCentrality <- data.frame(
person = V(actors)$name,
Eigenvector = eigen,
Closeness = close,
Betweenness = betw,
stringsAsFactors = FALSE
)
head(DFCentrality)
cor_mat <- cor(DFCentrality[, c("Eigenvector","Closeness","Betweenness")])
print(round(cor_mat, 3))
cor_df <- as.data.frame(as.table(cor_mat))
names(cor_df) <- c("Measure1","Measure2","Correlation")
ggplot(cor_df, aes(Measure1, Measure2, fill = Correlation)) +
geom_tile() +
geom_text(aes(label = round(Correlation, 2)), size = 4) +
coord_equal() +
theme_minimal() +
labs(title = "Correlation among centrality measures")
randomNet <- sample_gnp(vcount(actors), p = edge_density(actors), directed = FALSE)
t_real <- transitivity(actors, type = "global")
t_rand <- transitivity(RandomNet, type = "global")
cat("Transitivity real:", round(t_real, 3), "\n")
cat("Transitivity random:", round(t_rand, 3), "\n")
cat("Ratio real/random:", round(t_real / t_rand, 2), "\n")
gn <- cluster_edge_betweenness(actors)
lv <- cluster_louvain(actors)
mod_gn <- modularity(gn)
mod_lv <- modularity(lv)
cat("Girvan-Newman modularity:", round(mod_gn, 3), "\n")
cat("Louvain modularity:", round(mod_lv, 3), "\n")
# Pick best by modularity and plot it
best_method <- ifelse(mod_lv >= mod_gn, "Louvain", "Girvan-Newman")
cat("Best method:", best_method, "\n")
V(actors)$community <- if (best_method == "Louvain") {
as.factor(membership(lv))
} else {
as.factor(membership(gn))
}
ggraph(actors, layout = "fr") +
geom_edge_link(alpha = 0.25) +
geom_node_point(aes(color = community), size = 5) +
geom_node_text(aes(label = name), repel = TRUE, size = 3) +
theme_graph() +
labs(title = paste("Communities (best =", best_method, ")"))
library(igraph)
library(ggraph)
library(ggplot2)
theme_set(theme_minimal(base_family = "sans"))
set.seed(123)
actors <- read_graph("https://raw.githubusercontent.com/DACSS-Anjelica/Homework_2/refs/heads/main/hollywood.graphml", format = "graphml")
summary(actors)
ggraph(graph = actors) +
geom_edge_link(aes(label = weight), alpha = 0.5, label_size = 2.5, angle_calc = "along") +
geom_node_text(aes(label = name, color = as.factor(wonOscar)), repel = TRUE) +
scale_color_manual(values = c("red", "blue")) +
theme_graph()
# Eigenvector Centrality
eigen <- eigen_centrality(actors)$vector
# Closeness
close <- closeness(actors, normalized = TRUE)
#Betweeness
betw  <- betweenness(actors, normalized = TRUE)
DFCentrality <- data.frame(
person = V(actors)$name,
Eigenvector = eigen,
Closeness = close,
Betweenness = betw,
stringsAsFactors = FALSE
)
head(DFCentrality)
cor_mat <- cor(DFCentrality[, c("Eigenvector","Closeness","Betweenness")])
print(round(cor_mat, 3))
cor_df <- as.data.frame(as.table(cor_mat))
names(cor_df) <- c("Measure1","Measure2","Correlation")
ggplot(cor_df, aes(Measure1, Measure2, fill = Correlation)) +
geom_tile() +
geom_text(aes(label = round(Correlation, 2)), size = 4) +
coord_equal() +
theme_minimal() +
labs(title = "Correlation among centrality measures")
randomNet <- sample_gnp(vcount(actors), p = edge_density(actors), directed = FALSE)
t_real <- transitivity(actors, type = "global")
t_rand <- transitivity(RandomNet, type = "global")
cat("Transitivity real:", round(t_real, 3), "\n")
cat("Transitivity random:", round(t_rand, 3), "\n")
cat("Ratio real/random:", round(t_real / t_rand, 2), "\n")
gn <- cluster_edge_betweenness(actors)
lv <- cluster_louvain(actors)
mod_gn <- modularity(gn)
mod_lv <- modularity(lv)
cat("Girvan-Newman modularity:", round(mod_gn, 3), "\n")
cat("Louvain modularity:", round(mod_lv, 3), "\n")
# Pick best by modularity and plot it
best_method <- ifelse(mod_lv >= mod_gn, "Louvain", "Girvan-Newman")
cat("Best method:", best_method, "\n")
V(actors)$community <- if (best_method == "Louvain") {
as.factor(membership(lv))
} else {
as.factor(membership(gn))
}
ggraph(actors, layout = "fr") +
geom_edge_link(alpha = 0.25) +
geom_node_point(aes(color = community), size = 5) +
geom_node_text(aes(label = name), repel = TRUE, size = 3) +
theme_graph() +
labs(title = paste("Communities (best =", best_method, ")"))
# Pick best by modularity and plot it
best_method <- ifelse(mod_lv >= mod_gn, "Louvain", "Girvan-Newman")
cat("Best method:", best_method, "\n")
V(actors)$community <- if (best_method == "Louvain") {
as.factor(membership(lv))
} else {
as.factor(membership(gn))
}
ggraph(actors, layout = "fr") +
geom_edge_link(alpha = 0.25) +
geom_node_point(aes(color = community), size = 5) +
geom_node_text(aes(label = name), repel = TRUE, size = 3) +
theme_graph() +
labs(title = paste("Communities (best =", best_method, ")"))
# Pick best by modularity and plot it
best_method <- ifelse(mod_lv >= mod_gn, "Louvain", "Girvan-Newman")
cat("Best method:", best_method, "\n")
V(actors)$community <- if (best_method == "Louvain") {
as.factor(membership(lv))
} else {
as.factor(membership(gn))
}
ggraph(actors, layout = "fr") +
geom_edge_link(alpha = 0.25) +
geom_node_point(aes(color = community), size = 5) +
geom_node_text(aes(label = name), repel = TRUE, size = 3, family = "sans") +
theme_graph(base_family = "sans")
ggraph(graph = actors) +
geom_edge_link(aes(label = weight), alpha = 0.5, label_size = 2.5, angle_calc = "along") +
geom_node_text(aes(label = name, color = as.factor(wonOscar)), repel = TRUE) +
scale_color_manual(values = c("red", "blue")) +
theme_graph()
library(igraph)
library(ggraph)
library(ggplot2)
theme_set(theme_minimal(base_family = "sans"))
set.seed(123)
actors <- read_graph("https://raw.githubusercontent.com/DACSS-Anjelica/Homework_2/refs/heads/main/hollywood.graphml", format = "graphml")
summary(actors)
ggraph(graph = actors) +
geom_edge_link(aes(label = weight), alpha = 0.5, label_size = 2.5, angle_calc = "along") +
geom_node_text(aes(label = name, color = as.factor(wonOscar)), repel = TRUE) +
scale_color_manual(values = c("red", "blue")) +
theme_graph()
# Eigenvector Centrality
eigen <- eigen_centrality(actors)$vector
# Closeness
close <- closeness(actors, normalized = TRUE)
#Betweeness
betw  <- betweenness(actors, normalized = TRUE)
DFCentrality <- data.frame(
person = V(actors)$name,
Eigenvector = eigen,
Closeness = close,
Betweenness = betw,
stringsAsFactors = FALSE
)
head(DFCentrality)
cor_mat <- cor(DFCentrality[, c("Eigenvector","Closeness","Betweenness")])
print(round(cor_mat, 3))
cor_df <- as.data.frame(as.table(cor_mat))
names(cor_df) <- c("Measure1","Measure2","Correlation")
ggplot(cor_df, aes(Measure1, Measure2, fill = Correlation)) +
geom_tile() +
geom_text(aes(label = round(Correlation, 2)), size = 4) +
coord_equal() +
theme_minimal() +
labs(title = "Correlation among centrality measures")
randomNet <- sample_gnp(vcount(actors), p = edge_density(actors), directed = FALSE)
t_real <- transitivity(actors, type = "global")
t_rand <- transitivity(RandomNet, type = "global")
cat("Transitivity real:", round(t_real, 3), "\n")
cat("Transitivity random:", round(t_rand, 3), "\n")
cat("Ratio real/random:", round(t_real / t_rand, 2), "\n")
gn <- cluster_edge_betweenness(actors)
lv <- cluster_louvain(actors)
mod_gn <- modularity(gn)
mod_lv <- modularity(lv)
cat("Girvan-Newman modularity:", round(mod_gn, 3), "\n")
cat("Louvain modularity:", round(mod_lv, 3), "\n")
# Pick best by modularity and plot it
best_method <- ifelse(mod_lv >= mod_gn, "Louvain", "Girvan-Newman")
cat("Best method:", best_method, "\n")
V(actors)$community <- if (best_method == "Louvain") {
as.factor(membership(lv))
} else {
as.factor(membership(gn))
}
ggraph(actors, layout = "fr") +
geom_edge_link(alpha = 0.25) +
geom_node_point(aes(color = community), size = 5) +
geom_node_text(aes(label = name), repel = TRUE, size = 3, family = "sans") +
theme_graph(base_family = "sans")
library(igraph)
library(ggraph)
library(ggplot2)
library(igraph)
library(ggraph)
library(ggplot2)
set.seed(123)
actors <- read_graph("https://raw.githubusercontent.com/DACSS-Anjelica/Homework_2/refs/heads/main/hollywood.graphml", format = "graphml")
summary(actors)
ggraph(graph = actors) +
geom_edge_link(aes(label = weight), alpha = 0.5, label_size = 2.5, angle_calc = "along") +
geom_node_text(aes(label = name, color = as.factor(wonOscar)), repel = TRUE) +
scale_color_manual(values = c("red", "blue")) +
theme_graph()
# Eigenvector Centrality
eigen <- eigen_centrality(actors)$vector
# Closeness
close <- closeness(actors, normalized = TRUE)
#Betweeness
betw  <- betweenness(actors, normalized = TRUE)
DFCentrality <- data.frame(
person = V(actors)$name,
Eigenvector = eigen,
Closeness = close,
Betweenness = betw,
stringsAsFactors = FALSE
)
head(DFCentrality)
cor_mat <- cor(DFCentrality[, c("Eigenvector","Closeness","Betweenness")])
print(round(cor_mat, 3))
cor_df <- as.data.frame(as.table(cor_mat))
names(cor_df) <- c("Measure1","Measure2","Correlation")
ggplot(cor_df, aes(Measure1, Measure2, fill = Correlation)) +
geom_tile() +
geom_text(aes(label = round(Correlation, 2)), size = 4) +
coord_equal() +
theme_minimal() +
labs(title = "Correlation among centrality measures")
randomNet <- sample_gnp(vcount(actors), p = edge_density(actors), directed = FALSE)
t_real <- transitivity(actors, type = "global")
t_rand <- transitivity(RandomNet, type = "global")
cat("Transitivity real:", round(t_real, 3), "\n")
cat("Transitivity random:", round(t_rand, 3), "\n")
cat("Ratio real/random:", round(t_real / t_rand, 2), "\n")
gn <- cluster_edge_betweenness(actors)
lv <- cluster_louvain(actors)
mod_gn <- modularity(gn)
mod_lv <- modularity(lv)
cat("Girvan-Newman modularity:", round(mod_gn, 3), "\n")
cat("Louvain modularity:", round(mod_lv, 3), "\n")
# Pick best by modularity and plot it
best_method <- ifelse(mod_lv >= mod_gn, "Louvain", "Girvan-Newman")
cat("Best method:", best_method, "\n")
V(actors)$community <- if (best_method == "Louvain") {
as.factor(membership(lv))
} else {
as.factor(membership(gn))
}
ggraph(actors, layout = "fr") +
geom_edge_link(alpha = 0.25) +
geom_node_point(aes(color = community), size = 5) +
geom_node_text(aes(label = name), repel = TRUE, size = 3, family = "sans") +
theme_graph(base_family = "sans")
gn <- cluster_edge_betweenness(actors)
lv <- cluster_louvain(actors)
mod_gn <- modularity(gn)
mod_lv <- modularity(lv)
cat("Girvan-Newman modularity:", round(mod_gn, 3), "\n")
cat("Louvain modularity:", round(mod_lv, 3), "\n")
actors <- read_graph("https://raw.githubusercontent.com/DACSS-Anjelica/Homework_2/main/hollywood.graphml", format = "graphml")
summary(actors)
ggraph(graph = actors) +
geom_edge_link(aes(label = weight), alpha = 0.5, label_size = 2.5, angle_calc = "along") +
geom_node_text(aes(label = name, color = as.factor(wonOscar)), repel = TRUE) +
scale_color_manual(values = c("red", "blue")) +
theme_graph()
randomNet <- sample_gnp(vcount(actors), p = edge_density(actors), directed = FALSE)
t_real <- transitivity(actors, type = "global")
t_rand <- transitivity(randomNet, type = "global")
cat("Transitivity real:", round(t_real, 3), "\n")
cat("Transitivity random:", round(t_rand, 3), "\n")
cat("Ratio real/random:", round(t_real / t_rand, 2), "\n")
E(EliteNet)
